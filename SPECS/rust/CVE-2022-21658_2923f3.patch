From 2923f3a4659326067b5c9dd0ff6e890e4e0681e3 Mon Sep 17 00:00:00 2001
From: Hans Kratz <hans@appfour.com>
Date: Thu, 20 Jan 2022 12:43:54 +0100
Subject: [PATCH] Fuchsia apparently does not have DT_UNKNOWN.

---
 library/std/src/sys/unix/fs.rs | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/library/std/src/sys/unix/fs.rs b/library/std/src/sys/unix/fs.rs
index ca7f132a8b344..249838fd655bb 100644
--- a/library/std/src/sys/unix/fs.rs
+++ b/library/std/src/sys/unix/fs.rs
@@ -1639,11 +1639,20 @@ mod remove_dir_impl {
         None
     }
 
+    #[cfg(target_os = "fuchsia")]
+    fn is_dir(ent: &DirEntry) -> Option<bool> {
+        match ent.entry.d_type {
+            libc::DT_DIR => Some(true),
+            _ => Some(false),
+        }
+    }
+
     #[cfg(not(any(
         target_os = "solaris",
         target_os = "illumos",
         target_os = "haiku",
-        target_os = "vxworks"
+        target_os = "vxworks",
+        target_os = "fuchsia"
     )))]
     fn is_dir(ent: &DirEntry) -> Option<bool> {
         match ent.entry.d_type {
